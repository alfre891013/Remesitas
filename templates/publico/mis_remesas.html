{% extends "base.html" %}

{% block title %}Mis Remesas - Happy Remesitas{% endblock %}

{% block content_public %}
<div class="min-vh-100" style="background: linear-gradient(135deg, #10B981 0%, #059669 100%);">
    <div class="container py-5">
        <div class="text-center text-white mb-5">
            <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo" style="height: 80px;" class="mb-3">
            <h2>Mis Remesas</h2>
            <p>Consulta el estado de tus envios</p>
        </div>

        <div class="row justify-content-center mb-4">
            <div class="col-md-6">
                <div class="card shadow">
                    <div class="card-body">
                        <form method="POST">
                            <div class="mb-3">
                                <label class="form-label"><i class="bi bi-phone"></i> Tu numero de telefono</label>
                                <input type="tel" name="telefono" class="form-control form-control-lg"
                                       placeholder="+1 786 555 1234" value="{{ telefono or '' }}" required>
                                <small class="text-muted">El mismo numero con el que solicitaste</small>
                            </div>
                            <button type="submit" class="btn btn-success btn-lg w-100">
                                <i class="bi bi-search"></i> Buscar mis remesas
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        {% if error %}
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="alert alert-warning text-center">{{ error }}</div>
            </div>
        </div>
        {% endif %}

        {% if remesas %}
        <div class="row justify-content-center">
            <div class="col-md-10">
                <h5 class="text-white mb-3">Encontramos {{ remesas|length }} remesa(s)</h5>
                {% for r in remesas %}
                <div class="card mb-3 shadow">
                    <div class="card-body">
                        <div class="row align-items-center">
                            <div class="col-md-2 text-center">
                                {% if r.estado == 'entregada' %}
                                <span class="badge bg-success p-2">Entregada</span>
                                {% elif r.estado == 'en_proceso' %}
                                <span class="badge bg-primary p-2">En camino</span>
                                {% elif r.estado == 'pendiente' %}
                                <span class="badge bg-warning text-dark p-2">Pendiente</span>
                                {% elif r.estado == 'solicitud' %}
                                <span class="badge bg-info p-2">En revision</span>
                                {% else %}
                                <span class="badge bg-secondary p-2">{{ r.estado }}</span>
                                {% endif %}
                            </div>
                            <div class="col-md-6">
                                <h5 class="mb-1">{{ r.codigo }}</h5>
                                <p class="mb-0 text-muted">Para: <strong>{{ r.beneficiario_nombre }}</strong></p>
                                <small class="text-muted">{{ r.fecha_creacion.strftime('%d/%m/%Y') }}</small>
                            </div>
                            <div class="col-md-4 text-end">
                                <h4 class="text-success">${{ "%.2f"|format(r.monto_envio) }} USD</h4>
                                <small>{{ "%.2f"|format(r.monto_entrega) }} {{ r.moneda_entrega }}</small>
                                <div class="mt-2">
                                    <a href="{{ url_for('publico.repetir_remesa', id=r.id) }}" class="btn btn-sm btn-outline-success">
                                        <i class="bi bi-arrow-repeat"></i> Repetir
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <div class="text-center mt-4">
            <a href="{{ url_for('publico.solicitar_remesa') }}" class="btn btn-light btn-lg">Nueva remesa</a>
            <a href="{{ url_for('index') }}" class="btn btn-outline-light btn-lg ms-2">Inicio</a>
        </div>
    </div>
</div>
{% endblock %}
